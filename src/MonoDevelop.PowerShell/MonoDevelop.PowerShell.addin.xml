<ExtensionModel>
	<Runtime>
		<Import assembly="MonoDevelop.PowerShell.dll" />
		<Import assembly="Microsoft.PowerShell.EditorServices.Client.dll" />

		<Import file="scripts/Start-EditorServices.ps1" />

		<Import file="modules/PowerShellEditorServices/PowerShellEditorServices.psd1" />
		<Import file="modules/PowerShellEditorServices/PowerShellEditorServices.psm1" />
		<Import file="modules/PowerShellEditorServices/bin/Desktop/Microsoft.PowerShell.EditorServices.Host.dll" />
		<Import file="modules/PowerShellEditorServices/bin/Desktop/Microsoft.PowerShell.EditorServices.Protocol.dll" />
		<Import file="modules/PowerShellEditorServices/bin/Desktop/Microsoft.PowerShell.EditorServices.dll" />
		<Import file="modules/PowerShellEditorServices/bin/Desktop/Newtonsoft.Json.dll" />
		<Import file="modules/PowerShellEditorServices/bin/Nano/Microsoft.PowerShell.EditorServices.Nano.dll" />
	</Runtime>

	<Extension path="/MonoDevelop/Core/MimeTypes">
		<MimeType
			id="application/powershell"
			_description="PowerShell"
			isText="true">
			<File pattern="*.ps1" />
		</MimeType>
		<MimeType
			id="application/powershell-manifest"
			_description="PowerShell Manifest"
			isText="true">
			<File pattern="*.psd1" />
		</MimeType>
		<MimeType
			id="application/powershell-module"
			_description="PowerShell Module"
			isText="true">
			<File pattern="*.psm1" />
		</MimeType>
	</Extension>

	<Extension path="/MonoDevelop/Ide/FileFilters">
		<FileFilter
			id="PowerShellFiles"
			_label="PowerShell Files"
			extensions="*.ps1;*.psm1*.psd1" />
	</Extension>

	<Extension path="/MonoDevelop/SourceEditor2/SyntaxModes">
		<Templates resource="PowerShellSyntaxMode.xml" />
	</Extension>

	<Extension path="/MonoDevelop/Ide/TextEditorExtensions">
		<Class
			id="PowerShellTextEditorExtension"
			fileExtensions=".ps1, .psd1, .psm1"
			class="MonoDevelop.PowerShell.PowerShellTextEditorExtension" />
	</Extension>

	<Extension path="/MonoDevelop/Ide/Pads">
		<Pad
			id="MonoDevelop.PowerShell.PowerShellOutputPad"
			defaultLayout="*"
			defaultPlacement="Center Bottom"
			defaultStatus="AutoHide"
			icon="md-console"
			class="MonoDevelop.PowerShell.PowerShellOutputPad"
			_label="PowerShell Editor Services" />
	</Extension>

		<Extension path="/MonoDevelop/Ide/Commands">
		<Category _name="Code Navigation" id="CodeNavigation">
			<Command
				id="MonoDevelop.PowerShell.PowerShellCommands.FindReferences"
				_label="_Find References"
				shortcut="Shift|F12"
				macShortcut="Shift|Meta|R Shift|F12"/>
		</Category>
	</Extension>

	<Extension path = "/MonoDevelop/SourceEditor2/ContextMenu/Editor">
		<Condition id="FileType" fileExtensions=".ps1,.psm1,.psd1">
			<CommandItem
				id="MonoDevelop.PowerShell.PowerShellCommands.FindReferences"
				insertafter="MonoDevelop.SourceEditor.SourceEditorCommands.MarkerOperations"
				insertbefore="MonoDevelop.Debugger.DebugCommands.ExpressionEvaluator" />
		</Condition>
	</Extension>
</ExtensionModel>

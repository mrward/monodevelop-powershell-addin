<ExtensionModel>
	<Runtime>
		<Import assembly="MonoDevelop.PowerShell.dll" />
		<Import assembly="Microsoft.PowerShell.EditorServices.Client.dll" />

		<Import file="scripts/Start-EditorServices.ps1" />

		<Import file="modules/PowerShellEditorServices/PowerShellEditorServices.psd1" />
		<Import file="modules/PowerShellEditorServices/PowerShellEditorServices.psm1" />
		<Import file="modules/PowerShellEditorServices/bin/Desktop/Microsoft.PowerShell.EditorServices.Host.dll" />
		<Import file="modules/PowerShellEditorServices/bin/Desktop/Microsoft.PowerShell.EditorServices.Protocol.dll" />
		<Import file="modules/PowerShellEditorServices/bin/Desktop/Microsoft.PowerShell.EditorServices.dll" />
		<Import file="modules/PowerShellEditorServices/bin/Desktop/Newtonsoft.Json.dll" />
		<Import file="modules/PowerShellEditorServices/bin/Nano/Microsoft.PowerShell.EditorServices.Nano.dll" />
	</Runtime>

	<Extension path="/MonoDevelop/Core/MimeTypes">
		<MimeType
			id="application/powershell"
			_description="PowerShell"
			isText="true">
			<File pattern="*.ps1" />
		</MimeType>
		<MimeType
			id="application/powershell-manifest"
			_description="PowerShell Manifest"
			isText="true">
			<File pattern="*.psd1" />
		</MimeType>
		<MimeType
			id="application/powershell-module"
			_description="PowerShell Module"
			isText="true">
			<File pattern="*.psm1" />
		</MimeType>
	</Extension>

	<Extension path="/MonoDevelop/Ide/FileFilters">
		<FileFilter
			id="PowerShellFiles"
			_label="PowerShell Files"
			extensions="*.ps1;*.psm1;*.psd1" />
	</Extension>

	<Extension path="/MonoDevelop/SourceEditor2/SyntaxModes">
		<Templates resource="PowerShellSyntaxMode.xml" />
	</Extension>

	<Extension path="/MonoDevelop/Ide/TextEditorExtensions">
		<Class
			id="PowerShellTextEditorExtension"
			fileExtensions=".ps1, .psd1, .psm1"
			class="MonoDevelop.PowerShell.PowerShellTextEditorExtension" />
	</Extension>

	<Extension path="/MonoDevelop/Ide/Pads">
		<Pad
			id="MonoDevelop.PowerShell.PowerShellOutputPad"
			defaultLayout="*"
			defaultPlacement="Center Bottom"
			defaultStatus="AutoHide"
			icon="md-console"
			class="MonoDevelop.PowerShell.PowerShellOutputPad"
			_label="PowerShell Editor Services" />
	</Extension>

	<Extension path="/MonoDevelop/Ide/Commands">
		<Category id="PowerShell" _name="PowerShell">
			<Command
				id="MonoDevelop.PowerShell.PowerShellCommands.Stop"
				icon="gtk-stop"
				macShortcut="Shift|Meta|Return Shift|F5"
				shortcut="Shift|F5"
				_description="Stop current build or application execution"
				_label="_Stop" />
		</Category>
	</Extension>

	<Extension path="/MonoDevelop/SourceEditor2/ContextMenu/Editor">
		<Condition id="FileType" fileExtensions=".ps1,.psm1,.psd1">
			<CommandItem
				id="MonoDevelop.Refactoring.RefactoryCommands.FindReferences"
				insertafter="MonoDevelop.SourceEditor.SourceEditorCommands.MarkerOperations"
				insertbefore="MonoDevelop.Debugger.DebugCommands.ExpressionEvaluator" />
			<CommandItem
				id="MonoDevelop.Ide.Commands.EditCommands.Rename"
				insertafter="MonoDevelop.SourceEditor.SourceEditorCommands.MarkerOperations"
				insertbefore="MonoDevelop.Debugger.DebugCommands.ExpressionEvaluator" />
			<CommandItem
				id="MonoDevelop.Ide.Commands.HelpCommands.Help"
				insertafter="MonoDevelop.SourceEditor.SourceEditorCommands.MarkerOperations"
				insertbefore="MonoDevelop.Debugger.DebugCommands.ExpressionEvaluator" />
		</Condition>
	</Extension>

	<Extension path="/MonoDevelop/Debugging/DebuggerEngines">
		<DebuggerEngine
			id="MonoDevelop.PowerShell"
			name="PowerShell Debugger"
			features="Breakpoints, Pause, Stepping, DebugFile"
			type="MonoDevelop.PowerShell.PowerShellDebuggerEngine" />
	</Extension>
</ExtensionModel>
